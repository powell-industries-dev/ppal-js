(function(c,n){typeof exports=="object"&&typeof module<"u"?module.exports=n(require("moment"),require("lodash")):typeof define=="function"&&define.amd?define(["moment","lodash"],n):(c=typeof globalThis<"u"?globalThis:c||self,c.ppal=n(c.moment,c._))})(this,function(c,n){"use strict";const o=[];for(let t=0;t<256;++t)o.push((t+256).toString(16).slice(1));function h(t,e=0){return(o[t[e+0]]+o[t[e+1]]+o[t[e+2]]+o[t[e+3]]+"-"+o[t[e+4]]+o[t[e+5]]+"-"+o[t[e+6]]+o[t[e+7]]+"-"+o[t[e+8]]+o[t[e+9]]+"-"+o[t[e+10]]+o[t[e+11]]+o[t[e+12]]+o[t[e+13]]+o[t[e+14]]+o[t[e+15]]).toLowerCase()}let d;const l=new Uint8Array(16);function y(){if(!d){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");d=crypto.getRandomValues.bind(crypto)}return d(l)}const p={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function x(t,e,r){if(p.randomUUID&&!t)return p.randomUUID();t=t||{};const i=t.random??t.rng?.()??y();if(i.length<16)throw new Error("Random bytes length must be >= 16");return i[6]=i[6]&15|64,i[8]=i[8]&63|128,h(i)}const a={id:function(t){return{$oid:t}},date:function(t){return{$date:t}},object:function(t){const e={};for(const r of n.keys(t)){const i=t[r];n.includes(r,"date")?e[r]=m.wrap(i):e[r]=i}return e}},S={date:function(){return c(new Date).toISOString()}},w={generateObjectId:function(){const t=(new Date().getTime()/1e3|0).toString(16),e="xxxxxxxxxxxxxxxx".replace(/x/g,()=>(Math.random()*16|0).toString(16)).toLowerCase();return`${t}${e}`},generateUuid:function(){return x()},wrap:a.id},b={diff:function({original:t,updated:e,prefix:r=""}){return!n.isObject(t)||!n.isObject(e)?n.isEqual(t,e)?{}:{[r.slice(0,-1)]:e}:n.isArray(t)&&n.isArray(e)?n.isEqual(t,e)?{}:{[r.slice(0,-1)]:e}:n.transform(e,(i,s,u)=>{const f=`${r}${u}`;if(!n.has(t,u))i[f]=s;else if(!n.isEqual(s,t[u]))if(n.isObject(s)&&n.isObject(t[u])){const D=this.diff({original:t[u],updated:s,prefix:`${f}.`});n.assign(i,D)}else i[f]=s},{})},hasProperties:function({object:t,properties:e}){return n.some(e,r=>!n.isUndefined(n.get(t,r)))},strip:function(t,e=!1){if(!n.isObjectLike(t)&&e)throw new TypeError("strip expects an object");const r={};for(const i of n.keys(t)){const s=t[i];if(n.isArray(s)){r[i]=n.cloneDeep(s);continue}if(n.isObjectLike(s)){const u=n.keys(s);if(n.size(u)===1&&n.startsWith(u[0],"$")){r[i]=s[u[0]];continue}r[i]=this.strip(s,!0);continue}r[i]=s}return r},wrap:a.object},g={uniqueInArray:function({string:t,array:e}){return!new Set(e).has(t)}},m={format:function({date:t,type:e,timezone:r="America/Denver"}){switch(e){case"DayOnly":let i=c(t).format("YYYY-MM-DD");return c.tz(i,r).set({hour:6,minute:0}).toISOString();case"Timestamp":return c(t).toISOString();default:throw new Error(`${e}: This type isn't supported, please check your spelling.`)}},default:S.date,wrap:a.date};return{id:w,object:b,string:g,date:m,behavior:{inputDiff:function({value:t,initialData:e,theme:r}){return t!==e?`${r.primary}40`:null}}}});
