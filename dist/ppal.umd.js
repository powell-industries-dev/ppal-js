(function(c,n){typeof exports=="object"&&typeof module<"u"?module.exports=n(require("moment"),require("lodash")):typeof define=="function"&&define.amd?define(["moment","lodash"],n):(c=typeof globalThis<"u"?globalThis:c||self,c.ppal=n(c.moment,c._))})(this,function(c,n){"use strict";const i=[];for(let t=0;t<256;++t)i.push((t+256).toString(16).slice(1));function m(t,e=0){return(i[t[e+0]]+i[t[e+1]]+i[t[e+2]]+i[t[e+3]]+"-"+i[t[e+4]]+i[t[e+5]]+"-"+i[t[e+6]]+i[t[e+7]]+"-"+i[t[e+8]]+i[t[e+9]]+"-"+i[t[e+10]]+i[t[e+11]]+i[t[e+12]]+i[t[e+13]]+i[t[e+14]]+i[t[e+15]]).toLowerCase()}let d;const h=new Uint8Array(16);function y(){if(!d){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");d=crypto.getRandomValues.bind(crypto)}return d(h)}const f={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function x(t,e,o){if(f.randomUUID&&!t)return f.randomUUID();t=t||{};const r=t.random??t.rng?.()??y();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,m(r)}const p={id:function(t){return{$oid:t}},date:function(t){return{$date:t}}},l={date:function(){return c(new Date).toISOString()}},S={generateObjectId:function(){const t=(new Date().getTime()/1e3|0).toString(16),e="xxxxxxxxxxxxxxxx".replace(/x/g,()=>(Math.random()*16|0).toString(16)).toLowerCase();return`${t}${e}`},generateUuid:function(){return x()},wrap:p.id},g={diff:function({original:t,updated:e,prefix:o=""}){return!n.isObject(t)||!n.isObject(e)?n.isEqual(t,e)?{}:{[o.slice(0,-1)]:e}:n.isArray(t)&&n.isArray(e)?n.isEqual(t,e)?{}:{[o.slice(0,-1)]:e}:n.transform(e,(r,s,u)=>{const a=`${o}${u}`;if(!n.has(t,u))r[a]=s;else if(!n.isEqual(s,t[u]))if(n.isObject(s)&&n.isObject(t[u])){const D=this.diff({original:t[u],updated:s,prefix:`${a}.`});n.assign(r,D)}else r[a]=s},{})},hasProperties:function({object:t,properties:e}){return n.some(e,o=>!n.isUndefined(n.get(t,o)))},strip:function(t,e=!1){if(!n.isObjectLike(t)&&e)throw new TypeError("strip expects an object");const o={};for(const r of n.keys(t)){const s=t[r];if(n.isArray(s)){o[r]=n.cloneDeep(s);continue}if(n.isObjectLike(s)){const u=n.keys(s);if(n.size(u)===1&&n.startsWith(u[0],"$")){o[r]=s[u[0]];continue}o[r]=this.strip(s,!0);continue}o[r]=s}return o}},w={uniqueInArray:function({string:t,array:e}){return!new Set(e).has(t)}},b={format:function({date:t,type:e,timezone:o="America/Denver"}){switch(e){case"DayOnly":let r=c(t).format("YYYY-MM-DD");return c.tz(r,o).set({hour:6,minute:0}).toISOString();case"Timestamp":return c(t).toISOString();default:throw new Error(`${e}: This type isn't supported, please check your spelling.`)}},default:l.date,wrap:p.date};return{id:S,object:g,string:w,date:b,behavior:{inputDiff:function({value:t,initialData:e,theme:o}){return t!==e?`${o.primary}40`:null}}}});
